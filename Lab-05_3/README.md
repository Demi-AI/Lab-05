# Lab-05_3：大學課程註冊系統

## 情境：

設計一個大學課程註冊系統的資料庫。系統需管理學生、課程、講師以及學生的選課記錄。

## 資料基本包含：

* 學生：學號、學生姓名、主修科系名稱、主修科系辦公室地點。
* 課程：課程代碼、課程名稱、學分數、開課系所代碼、開課系所名稱。
* 講師：講師編號、講師姓名、講師所屬系所代碼、講師所屬系所名稱、講師辦公室號碼。
* 選課記錄：學號、學生姓名、課程代碼、課程名稱、學期、授課講師編號、授課講師姓名、成績。

## 假設：

* 一位講師可能教授多門課程，一門課程也可能由多位講師講授 (例如，不同班級或共同授課)。
* 學生選修特定學期的特定課程，由特定講師授課。

---

## 任務：

### 1. 初始未正規化資料表分析

我們有一個包含所有資訊的扁平化資料表：

| 學號 | 學生姓名 | 主修科系名稱 | 主修科系辦公室地點 | 課程代碼 | 課程名稱 | 學分數 | 開課系所代碼 | 開課系所名稱 | 學期 | 講師編號 | 講師姓名 | 講師所屬系所代碼 | 講師所屬系所名稱 | 講師辦公室號碼 | 成績 |
| -- | ---- | ------ | --------- | ---- | ---- | --- | ------ | ------ | -- | ---- | ---- | -------- | -------- | ------- | -- |

---

### 2. 函數相依性列表

列出所有合理的函數相依性。

```
FD1: 學號 → 學生姓名, 主修科系名稱
FD2: 主修科系名稱 → 主修科系辦公室地點
FD3: 課程代碼 → 課程名稱, 學分數, 開課系所代碼
FD4: 開課系所代碼 → 開課系所名稱
FD5: 講師編號 → 講師姓名, 講師所屬系所代碼
FD6: 講師所屬系所代碼 → 講師所屬系所名稱, 講師辦公室號碼
FD7: (學號, 課程代碼, 學期, 講師編號) → 成績
```

---

### 3. 正規化設計

將資料庫綱要正規化至 Boyce-Codd 正規化 (BCNF)。
如果 BCNF 導致過多的分解或效能問題，可以退回至 3NF，並說明理由。

* **第一正規化 (1NF)**：分解扁平化資料表，消除重複群組與多值屬性。

  * **選課紀錄資料表 (1NF)**：
    | 學號 | 學生姓名 | 主修科系名稱 | 主修科系辦公室地點 | 課程代碼 | 課程名稱 | 學分數 | 開課系所代碼 | 開課系所名稱 | 學期 | 講師編號 | 講師姓名 | 講師所屬系所代碼 | 講師所屬系所名稱 | 講師辦公室號碼 | 成績 |

* **第二正規化 (2NF)**：消除部分相依性，確保所有非主鍵屬性完全依賴主鍵。

  * **學生資料表 (2NF)**：
    | 學號 | 學生姓名 | 主修科系名稱 |

  * **主修科系資料表 (2NF)**：
    | 主修科系名稱 | 主修科系辦公室地點 |

  * **課程資料表 (2NF)**：
    | 課程代碼 | 課程名稱 | 學分數 | 開課系所代碼 |

  * **開課系所資料表 (2NF)**：
    | 開課系所代碼 | 開課系所名稱 |

  * **講師資料表 (2NF)**：
    | 講師編號 | 講師姓名 | 講師所屬系所代碼 |

  * **講師所屬系所資料表 (2NF)**：
    | 講師所屬系所代碼 | 講師所屬系所名稱 | 講師辦公室號碼 |

  * **選課記錄資料表 (2NF)**：
    | 學號 | 課程代碼 | 學期 | 講師編號 | 成績 |

* **第三正規化 (3NF)**：消除傳遞相依性。(例如：系所名稱 → 系所辦公室地點)。

  * **系所資料表 (3NF)**：
    | 系所代碼 | 系所名稱 | 系所辦公室地點 |

  * **學生資料表 (3NF)**：
    | 學號 | 學生姓名 | 主修科系代碼[FK] |

  * **課程資料表 (3NF)**：
    | 課程代碼 | 課程名稱 | 學分數 | 開課系所代碼[FK] |

  * **講師資料表 (3NF)**：
    | 講師編號 | 講師姓名 | 講師所屬系所代碼[FK] | 講師辦公室號碼 |

  * **選課記錄資料表 (3NF)**：
    | 學號[FK] | 課程代碼[FK] | 學期 | 講師編號[FK] | 成績 |

* **Boyce-Codd 正規化 (BCNF)**：所有函數相依性的決定因子都是候選鍵。檢查後，本系統所有表格皆符合 BCNF 規則，無需退回 3NF。

---

### 4. 分析與說明

討論在正規化過程中遇到的任何挑戰，特別是關於達成 BCNF 的部分。

#### 達成BCNF的挑戰：
1. **多重傳遞相依性**：系所資訊分散在多個實體中。
2. **複合主鍵複雜性**：選課記錄需要四個欄位組成主鍵。

如果選擇 3NF 而非 BCNF (或反之)，請說明您的設計決策。

#### 設計決策：
選擇BCNF而非3NF，理由如下：
1. **資料完整性**：BCNF提供更好的資料一致性。
2. **維護性**：系所資訊統一管理，避免異常。
3. **擴展性**：結構清晰，便於未來擴展。

---

### 5. 最終ERD結構

```
系所 (系所代碼[PK], 系所名稱, 系所辦公室地點)
    ↓ 1:N (主修科系)
學生 (學號[PK], 學生姓名, 主修科系代碼[FK])
    ↓ 1:N
選課記錄 (學號[PK][FK], 課程代碼[PK][FK], 學期[PK], 講師編號[PK][FK], 成績)
    ↑ N:1        ↑ N:1
課程 (課程代碼[PK], 課程名稱, 學分數, 開課系所代碼[FK])
                講師 (講師編號[PK], 講師姓名, 講師所屬系所代碼[FK], 講師辦公室號碼)
    ↑ N:1            ↑ N:1
系所 (開課)          系所 (所屬)
```

### 6. 實體關係圖 (ERD)

繪製最終的實體關係圖 (ERD)。

---